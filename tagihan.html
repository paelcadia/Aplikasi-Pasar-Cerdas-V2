<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pasar Cerdas - Tagihan</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Phosphor Icons -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <!-- Kustomisasi Warna agar mirip BCA -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        bca: {
                            dark: '#003D79',   /* Biru Gelap Khas BCA */
                            main: '#0060AF',   /* Biru Utama */
                            light: '#E5F3FF',  /* Biru Muda Background/Highlight */
                            gold: '#DAA520',   /* Aksen Gold/Kuning */
                        },
                        // Warna status
                        danger: '#EF4444', // Merah untuk Jatuh Tempo
                        warning: '#F59E0B', // Kuning untuk Belum Dibayar
                        success: '#10B981', // Hijau untuk Sudah Dibayar
                    }
                }
            }
        }
    </script>
    
    <style>
        /* Mengatur body dan font */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; 
        }
        
        /* Style Khas V2: Header Lengkung */
        .header-curve {
            border-bottom-left-radius: 30px;
            border-bottom-right-radius: 30px;
            position: relative; 
            overflow: hidden; 
        }

        /* Styling Ornamen Lingkaran */
        .ornament-circle-large {
            position: absolute;
            top: -50px;
            right: -50px;
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.1); 
            z-index: 0;
        }

        /* Utility untuk scrollbar */
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- Header Lengkung Biru dengan Total Tagihan -->
    <header class="bg-bca-main header-curve pb-0 top-0 z-20">
        <div class="ornament-circle-large"></div>
        <div class="max-w-md mx-auto relative z-10">
            <div class="flex items-center gap-3 text-white p-4 py-4"> 
                <!-- Tombol Kembali (Asumsi kembali ke main dashboard) -->
                <a href="main_dashboard.html" class="bg-white/20 hover:bg-white/30 p-2 rounded-full transition backdrop-blur-sm active:scale-95">
                    <i class="ph-bold ph-arrow-left text-xl"></i>
                </a>
                <h1 class="text-xl font-bold tracking-tight">Tagihan Retribusi Kios</h1>
            </div>

            <!-- Kartu Total Tagihan Belum Dibayar -->
            <div class="p-4 mx-4 mb-4 bg-white rounded-xl shadow-xl border border-bca-light/50 -translate-y-1">
                <p class="text-xs font-semibold text-gray-500 flex items-center gap-1">
                    <i class="ph-bold ph-calendar-check text-sm text-bca-main"></i> Total Tagihan Aktif
                </p>
                <div class="flex items-end justify-between mt-1">
                    <span class="text-2xl md:text-3xl font-extrabold text-bca-dark tracking-tight" id="totalTagihan">Rp 300.000</span>
                    <!-- Tombol Cepat Bayar Semua (Navigasi ke halaman bayar) -->
                    <a href="pay_retribution.html" class="bg-bca-main text-white text-sm font-semibold px-4 py-2 rounded-lg hover:bg-bca-dark transition active:scale-95 shadow-md shadow-bca-main/30">
                        Bayar Sekarang
                    </a>
                </div>
                <p class="text-[10px] text-gray-500 mt-2">Termasuk 1 tagihan jatuh tempo dan 2 tagihan aktif lainnya.</p>
            </div>
        </div>
    </header>

    <!-- Konten Utama: Daftar Tagihan dan Riwayat -->
    <main class="flex-grow max-w-md mx-auto p-4 w-full space-y-8"> 

        <!-- Bagian Tagihan Aktif -->
        <section class="space-y-4">
            <h2 class="text-base font-extrabold text-gray-700 flex items-center gap-2">
                <i class="ph-bold ph-list-bullets text-xl text-bca-main"></i> Tagihan Belum Dibayar
            </h2>

            <div class="space-y-3" id="tagihanList">
                <!-- Tagihan Item 1: JATUH TEMPO (Merah) -->
                <div class="tagihan-item bg-white p-4 rounded-xl shadow-md border-l-4 border-danger hover:shadow-lg transition active:scale-[0.99] cursor-pointer" data-status="danger" data-id="T202506">
                    <div class="flex justify-between items-start">
                        <!-- Kiri: Detail -->
                        <div class="flex-grow">
                            <h3 class="text-sm font-bold text-gray-800">Retribusi Bulanan</h3>
                            <p class="text-xs text-gray-500 mt-0.5">Periode: **Juni 2025**</p>
                            <p class="text-xs font-medium text-danger mt-1 flex items-center gap-1">
                                <i class="ph-fill ph-warning-circle text-sm"></i> Jatuh Tempo (3 Hari Lalu)
                            </p>
                        </div>
                        <!-- Kanan: Nominal & Tombol -->
                        <div class="text-right">
                            <p class="text-lg font-extrabold text-danger">Rp 105.000</p>
                            <a href="pay_retribution.html?id=T202506" class="mt-2 inline-block bg-danger text-white text-xs font-semibold px-3 py-1 rounded-full hover:bg-red-600 transition">
                                Bayar
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Tagihan Item 2: BELUM DIBAYAR (Kuning) -->
                <div class="tagihan-item bg-white p-4 rounded-xl shadow-md border-l-4 border-warning hover:shadow-lg transition active:scale-[0.99] cursor-pointer" data-status="warning" data-id="T202507">
                    <div class="flex justify-between items-start">
                        <div class="flex-grow">
                            <h3 class="text-sm font-bold text-gray-800">Retribusi Bulanan</h3>
                            <p class="text-xs text-gray-500 mt-0.5">Periode: **Juli 2025**</p>
                            <p class="text-xs font-medium text-warning mt-1 flex items-center gap-1">
                                <i class="ph-fill ph-clock-countdown text-sm"></i> Batas Bayar: 25 Juli 2025
                            </p>
                        </div>
                        <div class="text-right">
                            <p class="text-lg font-extrabold text-warning">Rp 100.000</p>
                            <a href="pay_retribution.html?id=T202507" class="mt-2 inline-block bg-warning text-white text-xs font-semibold px-3 py-1 rounded-full hover:bg-yellow-600 transition">
                                Bayar
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Tagihan Item 3: BELUM DIBAYAR (Kuning) -->
                <div class="tagihan-item bg-white p-4 rounded-xl shadow-md border-l-4 border-warning hover:shadow-lg transition active:scale-[0.99] cursor-pointer" data-status="warning" data-id="T202508">
                    <div class="flex justify-between items-start">
                        <div class="flex-grow">
                            <h3 class="text-sm font-bold text-gray-800">Retribusi Bulanan</h3>
                            <p class="text-xs text-gray-500 mt-0.5">Periode: **Agustus 2025**</p>
                            <p class="text-xs font-medium text-warning mt-1 flex items-center gap-1">
                                <i class="ph-fill ph-clock-countdown text-sm"></i> Batas Bayar: 25 Agustus 2025
                            </p>
                        </div>
                        <div class="text-right">
                            <p class="text-lg font-extrabold text-warning">Rp 95.000</p>
                            <a href="pay_retribution.html?id=T202508" class="mt-2 inline-block bg-warning text-white text-xs font-semibold px-3 py-1 rounded-full hover:bg-yellow-600 transition">
                                Bayar
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Bagian Riwayat Pembayaran -->
        <section class="space-y-4 pt-4 pb-8">
            <h2 class="text-base font-extrabold text-gray-700 flex items-center gap-2">
                <i class="ph-bold ph-receipt text-xl text-bca-main"></i> Riwayat Pembayaran
            </h2>

            <div class="space-y-3">
                <!-- Riwayat Item 1: SUKSES -->
                <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition active:scale-[0.99] cursor-pointer" data-status="success" data-id="H202505" onclick="showHistoryDetail('H202505')">
                    <div class="flex justify-between items-start">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded-full bg-success/10 flex items-center justify-center text-success">
                                <i class="ph-fill ph-check-circle text-xl"></i>
                            </div>
                            <div>
                                <h3 class="text-sm font-bold text-gray-800">Retribusi Mei 2025</h3>
                                <p class="text-xs text-gray-500 mt-0.5">Dibayar via QRIS • 20 Mei 2025</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <p class="text-sm font-bold text-success">-Rp 102.500</p>
                            <span class="text-[10px] font-bold text-success bg-success/10 px-2 py-0.5 rounded-full mt-1 inline-block">Selesai</span>
                        </div>
                    </div>
                </div>

                <!-- Riwayat Item 2: SUKSES -->
                <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition active:scale-[0.99] cursor-pointer" data-status="success" data-id="H202504" onclick="showHistoryDetail('H202504')">
                     <div class="flex justify-between items-start">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded-full bg-success/10 flex items-center justify-center text-success">
                                <i class="ph-fill ph-check-circle text-xl"></i>
                            </div>
                            <div>
                                <h3 class="text-sm font-bold text-gray-800">Retribusi April 2025</h3>
                                <p class="text-xs text-gray-500 mt-0.5">Dibayar via VA Bank • 18 April 2025</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <p class="text-sm font-bold text-success">-Rp 100.000</p>
                            <span class="text-[10px] font-bold text-success bg-success/10 px-2 py-0.5 rounded-full mt-1 inline-block">Selesai</span>
                        </div>
                    </div>
                </div>

                <!-- Tombol Lihat Semua Riwayat -->
                 <button onclick="showCustomModal('Riwayat Pembayaran', 'Anda akan diarahkan ke halaman detail riwayat transaksi untuk melihat semua pembayaran retribusi yang telah dilakukan.', null, 'Lanjutkan')" 
                        class="w-full text-center text-sm font-semibold text-bca-main hover:text-bca-dark transition py-2 mt-2 border-t border-dashed border-gray-300">
                    Lihat Semua Riwayat (23)
                </button>
            </div>
        </section>
    </main>

    <!-- Modal Kustom (Untuk menggantikan alert/confirm) -->
    <div id="customModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 hidden transition-opacity duration-300">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-sm transform transition-all duration-300 scale-95 opacity-0" id="modalContent">
            <div class="p-6">
                <h3 class="text-xl font-bold text-bca-dark mb-3" id="modalTitle">Judul</h3>
                <p class="text-sm text-gray-600 mb-6" id="modalMessage">Pesan</p>
                <div class="flex justify-end space-x-3">
                    <button id="modalCloseButton" class="text-gray-500 hover:text-gray-700 font-semibold text-sm px-4 py-2 rounded-lg transition">Tutup</button>
                    <button id="modalConfirmButton" class="bg-bca-main text-white font-semibold text-sm px-4 py-2 rounded-lg hover:bg-bca-dark transition active:scale-95">Konfirmasi</button>
                </div>
            </div>
        </div>
    </div>


    <script>
        // Fungsi untuk format Rupiah
        const formatRupiah = (angka) => {
            const numberString = angka.toString().replace(/[^,\d]/g, '');
            const split = numberString.split(',');
            const sisa = split[0].length % 3;
            let rupiah = split[0].substr(0, sisa);
            const ribuan = split[0].substr(sisa).match(/\d{3}/gi);

            if (ribuan) {
                const separator = sisa ? '.' : '';
                rupiah += separator + ribuan.join('.');
            }

            rupiah = split[1] != undefined ? rupiah + ',' + split[1] : rupiah;
            return 'Rp ' + rupiah;
        };

        // ===================================
        // LOGIKA MODAL KUSTOM
        // ===================================
        const modal = document.getElementById('customModal');
        const modalContent = document.getElementById('modalContent');
        const modalTitle = document.getElementById('modalTitle');
        const modalMessage = document.getElementById('modalMessage');
        const modalCloseButton = document.getElementById('modalCloseButton');
        const modalConfirmButton = document.getElementById('modalConfirmButton');

        let onConfirmCallback = null;

        function showCustomModal(title, message, confirmCallback = null, confirmText = 'OK') {
            // Reset state
            modalConfirmButton.classList.remove('hidden');
            modalCloseButton.textContent = 'Tutup';
            onConfirmCallback = null;

            modalTitle.textContent = title;
            modalMessage.textContent = message;
            modalConfirmButton.textContent = confirmText;
            
            if (confirmCallback) {
                onConfirmCallback = confirmCallback;
            } else {
                // Jika tidak ada callback, sembunyikan tombol konfirmasi dan jadikan tombol tutup sebagai tombol utama
                modalConfirmButton.classList.add('hidden');
                modalCloseButton.textContent = confirmText; // Tombol Close jadi 'OK'
            }

            // Tampilkan modal
            modal.classList.remove('hidden');
            setTimeout(() => {
                modal.classList.add('opacity-100');
                modalContent.classList.add('scale-100', 'opacity-100');
                modalContent.classList.remove('scale-95', 'opacity-0');
            }, 10); // Sedikit delay untuk transisi
        }

        function hideCustomModal() {
            modal.classList.remove('opacity-100');
            modalContent.classList.remove('scale-100', 'opacity-100');
            modalContent.classList.add('scale-95', 'opacity-0');
            
            setTimeout(() => {
                modal.classList.add('hidden');
            }, 300); 
        }

        // Event listener untuk tombol Tutup
        modalCloseButton.addEventListener('click', hideCustomModal);
        
        // Event listener untuk tombol Konfirmasi
        modalConfirmButton.addEventListener('click', () => {
            if (onConfirmCallback) {
                onConfirmCallback();
            }
            hideCustomModal();
        });

        // ===================================
        // SIMULASI INTERAKSI
        // ===================================

        // Simulasi detail riwayat (akan navigasi ke history_detail.html)
        function showHistoryDetail(id) {
            showCustomModal(
                "Simulasi Navigasi", 
                `Anda akan melihat detail pembayaran untuk ID Transaksi: ${id}. \n\nIni akan mengarahkan Anda ke halaman detail riwayat.`, 
                () => {
                    // Navigasi ke halaman detail (misalnya history_detail.html)
                    window.location.href = 'history_detail.html?billId=' + id;
                }, 
                "Lihat Detail"
            );
        }
        
    </script>
</body>
</html>